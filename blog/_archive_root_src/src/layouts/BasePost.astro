---
// src/layouts/BasePost.astro
import type { CollectionEntry } from "astro:content";
const { post }: { post: CollectionEntry<"posts"> } = Astro.props;

const d = new Date(post.data.pubDate);
const iso = isNaN(d.valueOf()) ? "" : d.toISOString();
const desc = post.data.description ?? "";
const title = post.data.title ?? "PAVIE | Advocacia";
const tipo = post.data.type;
const persona = post.data.persona_publico;
---

<html lang="pt-BR">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>{title}</title>
    <meta name="description" content={desc} />
    <link rel="canonical" href={Astro.url.href} />

    <!-- OG/Twitter -->
    <meta property="og:type" content="article" />
    <meta property="og:title" content={title} />
    <meta property="og:description" content={desc} />
    {post.data.cover?.src && <meta property="og:image" content={post.data.cover.src} />}
    <meta name="twitter:card" content="summary_large_image" />

    <!-- JSON-LD Article -->
    {iso && (
      <script type="application/ld+json" set:html={JSON.stringify({
        "@context":"https://schema.org",
        "@type":"Article",
        "headline": title,
        "datePublished": iso,
        "author": [{ "@type":"Organization", "name": post.data.author }],
        "about": post.data.tags,
      })} />
    )}
  </head>
  <body>
    <header>
      <p><small>Tipo: {tipo} · Público: {persona.toUpperCase()}</small></p>
      <h1>{title}</h1>
      <p>{desc}</p>
      {post.data.cover?.src && (
        <img src={post.data.cover.src} alt={post.data.cover.alt} loading="eager" />
      )}
    </header>
    <div class="grid">
      <aside id="toc" aria-label="Sumário">
        <slot name="toc" />
      </aside>
      <main id="conteudo">
        <slot />
      </main>
    </div>
    <footer>
      <slot name="footer" />
    </footer>
  </body>
</html>
